[INFO][socket()] Allocate socket 3.
[INFO][bind()]:
[INFO][bind()] Socket 3 binded to (10.100.1.2: 10000).
[INFO][listen()] Socket 3; backlog 100;
[INFO][TCB::change_state] State of socket change from CLOSED to LISTEN.
[INFO][accept()]:
[INFO][handleTCPPacket()]
[INFO][TCPPacket::printTCPPacket()]
Pesudo Head: 
	Source Address: 10.100.1.1
	Destination Address: 10.100.1.2
	PTCL: 0x6
	TCP Length: 20
TCP Head: 
	Source Port: 1025
	Destination Port: 10000
	Sequence Number: 1804289383
	Acknowledgment Number: 0
	URG: 0
	ACK: 0
	PSH: 0
	RST: 0
	SYN: 1
	FIN: 0
	Window: 65528
	Checksum: 20616
	Urgent Pointer: 0
[INFO][handleTCPPacket()] The socket 3 is in state LISTEN.
[INFO][handleTCPPacket()]TCB:
	SND.UNA: 0
	SND.NXT: 0
	SND.WND: 65528
	RCV.NXT: 0
	RCV.WND: 524280
[INFO][TCB::change_state] State of socket change from CLOSED to LISTEN.
[INFO][handleTCPPacket()] The listen socket 3 receive SYN, add a new socket to listen queue.
[INFO][handleTCPPacket()]
[INFO][TCPPacket::printTCPPacket()]
Pesudo Head: 
	Source Address: 10.100.1.1
	Destination Address: 10.100.1.2
	PTCL: 0x6
	TCP Length: 20
TCP Head: 
	Source Port: 1025
	Destination Port: 10000
	Sequence Number: 1804289383
	Acknowledgment Number: 0
	URG: 0
	ACK: 0
	PSH: 0
	RST: 0
	SYN: 1
	FIN: 0
	Window: 65528
	Checksum: 20616
	Urgent Pointer: 0
[INFO][handleTCPPacket()] The socket 0 is in state LISTEN.
[INFO][handleTCPPacket()]TCB:
	SND.UNA: 0
	SND.NXT: 0
	SND.WND: 65528
	RCV.NXT: 1804289384
	RCV.WND: 524280
[INFO][accept()] Try to accept the socket with: (10.100.1.2:10000, 10.100.1.1:1025).
[INFO][accept()] Socket 3 Send <SEQ=ISS(1804289383)><ACK=RCV.NXT(1804289384)><CTL=SYN,ACK>
[INFO][TCB::change_state] State of socket change from LISTEN to SYN_RECV.
[INFO][accept()] Socket 3 Send <SEQ=ISS(1804289383)><ACK=RCV.NXT(1804289384)><CTL=SYN,ACK>
[INFO][handleTCPPacket()]
[INFO][TCPPacket::printTCPPacket()]
Pesudo Head: 
	Source Address: 10.100.1.1
	Destination Address: 10.100.1.2
	PTCL: 0x6
	TCP Length: 20
TCP Head: 
	Source Port: 1025
	Destination Port: 10000
	Sequence Number: 1804289383
	Acknowledgment Number: 0
	URG: 0
	ACK: 0
	PSH: 0
	RST: 0
	SYN: 1
	FIN: 0
	Window: 65528
	Checksum: 20616
	Urgent Pointer: 0
[INFO][handleTCPPacket()] The socket 4 is in state SYN_RECV.
[INFO][handleTCPPacket()]TCB:
	SND.UNA: 1804289383
	SND.NXT: 1804289384
	SND.WND: 65528
	RCV.NXT: 1804289384
	RCV.WND: 524280
[INFO][accept()] Socket 3 Send <SEQ=ISS(1804289383)><ACK=RCV.NXT(1804289384)><CTL=SYN,ACK>
[INFO][handleTCPPacket()]
[INFO][TCPPacket::printTCPPacket()]
Pesudo Head: 
	Source Address: 10.100.1.1
	Destination Address: 10.100.1.2
	PTCL: 0x6
	TCP Length: 20
TCP Head: 
	Source Port: 1025
	Destination Port: 10000
	Sequence Number: 1804289384
	Acknowledgment Number: 1804289384
	URG: 0
	ACK: 1
	PSH: 0
	RST: 0
	SYN: 0
	FIN: 0
	Window: 65528
	Checksum: 37267
	Urgent Pointer: 0
[INFO][handleTCPPacket()] The socket 4 is in state SYN_RECV.
[INFO][handleTCPPacket()]TCB:
	SND.UNA: 1804289383
	SND.NXT: 1804289384
	SND.WND: 65528
	RCV.NXT: 1804289384
	RCV.WND: 524280
[INFO][TCB::ackRetransQueue()] Socket 4; ACK 1804289384.
[INFO][TCB::change_state] State of socket change from SYN_RECV to ESTAB.
[INFO][TCB::ackRetransQueue()] Socket 4; ACK 1804289384.
[INFO][accept()] Accept successfully.
[INFO][write()]: data[0]=65.
[INFO][write()] Write 3 bytes from 10.100.1.2:10000 to 10.100.1.1:1025. Send <SEQ=SND.NXT(1804289384)><ACK=RCV.NXT(1804289384)><CTL=ACK>
[INFO][close()]:
[INFO][handleTCPPacket()]
[INFO][TCPPacket::printTCPPacket()]
Pesudo Head: 
	Source Address: 10.100.1.1
	Destination Address: 10.100.1.2
	PTCL: 0x6
	TCP Length: 20
TCP Head: 
	Source Port: 1025
	Destination Port: 10000
	Sequence Number: 1804289384
	Acknowledgment Number: 1804289384
	URG: 0
	ACK: 1
	PSH: 0
	RST: 0
	SYN: 0
	FIN: 0
	Window: 65525
	Checksum: 37270
	Urgent Pointer: 0
[INFO][handleTCPPacket()] The socket 4 is in state ESTAB.
[INFO][handleTCPPacket()]TCB:
	SND.UNA: 1804289384
	SND.NXT: 1804289387
	SND.WND: 65525
	RCV.NXT: 1804289384
	RCV.WND: 524280
[INFO][TCB::ackRetransQueue()] Socket 4; ACK 1804289384.
[INFO][handleTCPPacket()]
[INFO][TCPPacket::printTCPPacket()]
Pesudo Head: 
	Source Address: 10.100.1.1
	Destination Address: 10.100.1.2
	PTCL: 0x6
	TCP Length: 20
TCP Head: 
	Source Port: 1025
	Destination Port: 10000
	Sequence Number: 1804289384
	Acknowledgment Number: 1804289387
	URG: 0
	ACK: 1
	PSH: 0
	RST: 0
	SYN: 0
	FIN: 1
	Window: 65528
	Checksum: 37008
	Urgent Pointer: 0
[INFO][handleTCPPacket()] The socket 4 is in state ESTAB.
[INFO][handleTCPPacket()]TCB:
	SND.UNA: 1804289384
	SND.NXT: 1804289387
	SND.WND: 65528
	RCV.NXT: 1804289384
	RCV.WND: 524280
[INFO][TCB::ackRetransQueue()] Socket 4; ACK 1804289387.
[INFO][TCB::ackRetransQueue()] Remove packet with SEQ 1804289384 from retransmitt queue.
[INFO][TCB::ackRetransQueue()] Socket 4; ACK 1804289387.
[INFO][handleTCPPacket()] Receive FIN and send ACK of the FIN: <SEQ=SND.NXT(1804289387)><ACK=SEG.SEQ+1(1804289385)><CTL=ACK>.
[INFO][TCB::change_state] State of socket change from ESTAB to FINWAIT_1.
[INFO][TCB::change_state] State of socket change from ESTAB to CLOSE_WAIT.
[INFO][handleTCPPacket()]
[INFO][TCPPacket::printTCPPacket()]
Pesudo Head: 
	Source Address: 10.100.1.1
	Destination Address: 10.100.1.2
	PTCL: 0x6
	TCP Length: 20
TCP Head: 
	Source Port: 1025
	Destination Port: 10000
	Sequence Number: 1804289384
	Acknowledgment Number: 1804289387
	URG: 0
	ACK: 1
	PSH: 0
	RST: 0
	SYN: 0
	FIN: 1
	Window: 65528
	Checksum: 37008
	Urgent Pointer: 0
[INFO][handleTCPPacket()] The socket 4 is in state CLOSE_WAIT.
[INFO][handleTCPPacket()]TCB:
	SND.UNA: 1804289387
	SND.NXT: 1804289387
	SND.WND: 65528
	RCV.NXT: 1804289385
	RCV.WND: 524280
[INFO][handleTCPPacket()] The segment could not be received. Socket 4 send <SEQ=SND.NXT(1804289387)><ACK=RCV.NXT(1804289385)><CTL=ACK>
[INFO][close()] Socket 4 send FIN/ACK: <SEG=SND.NXT(1804289387)><ACK=RCV.NXT(1804289385)><CTL=FIN,ACK>.
[INFO][close()] Socket 4 resend FIN/ACK: <SEG=SND.NXT(1804289388)><ACK=RCV.NXT(1804289385)><CTL=FIN,ACK>.
[INFO][close()] Socket 4 resend FIN/ACK: <SEG=SND.NXT(1804289388)><ACK=RCV.NXT(1804289385)><CTL=FIN,ACK>.
[INFO][handleTCPPacket()]
[INFO][TCPPacket::printTCPPacket()]
Pesudo Head: 
	Source Address: 10.100.1.1
	Destination Address: 10.100.1.2
	PTCL: 0x6
	TCP Length: 20
TCP Head: 
	Source Port: 1025
	Destination Port: 10000
	Sequence Number: 1804289385
	Acknowledgment Number: 1804289388
	URG: 0
	ACK: 1
	PSH: 0
	RST: 0
	SYN: 0
	FIN: 0
	Window: 65528
	Checksum: 37262
	Urgent Pointer: 0
[INFO][handleTCPPacket()] The socket 4 is in state FINWAIT_1.
[INFO][handleTCPPacket()]TCB:
	SND.UNA: 1804289387
	SND.NXT: 1804289388
	SND.WND: 65528
	RCV.NXT: 1804289385
	RCV.WND: 524280
[INFO][TCB::ackRetransQueue()] Socket 4; ACK 1804289388.
[INFO][handleTCPPacket()] The FIN of socket 4 has been ACKed.
[INFO][TCB::change_state] State of socket change from FINWAIT_1 to FINWAIT_2.
[INFO][handleTCPPacket()]
[INFO][TCPPacket::printTCPPacket()]
Pesudo Head: 
	Source Address: 10.100.1.1
	Destination Address: 10.100.1.2
	PTCL: 0x6
	TCP Length: 20
TCP Head: 
	Source Port: 1025
	Destination Port: 10000
	Sequence Number: 1804289385
	Acknowledgment Number: 1804289388
	URG: 0
	ACK: 1
	PSH: 0
	RST: 0
	SYN: 0
	FIN: 0
	Window: 65528
	Checksum: 37262
	Urgent Pointer: 0
[INFO][handleTCPPacket()] The socket 4 is in state FINWAIT_2.
[INFO][handleTCPPacket()]TCB:
	SND.UNA: 1804289387
	SND.NXT: 1804289388
	SND.WND: 65528
	RCV.NXT: 1804289385
	RCV.WND: 524280
[INFO][TCB::ackRetransQueue()] Socket 4; ACK 1804289388.
[INFO][handleTCPPacket()]
[INFO][TCPPacket::printTCPPacket()]
Pesudo Head: 
	Source Address: 10.100.1.1
	Destination Address: 10.100.1.2
	PTCL: 0x6
	TCP Length: 20
TCP Head: 
	Source Port: 1025
	Destination Port: 10000
	Sequence Number: 1804289384
	Acknowledgment Number: 1804289388
	URG: 0
	ACK: 1
	PSH: 0
	RST: 0
	SYN: 0
	FIN: 1
	Window: 65528
	Checksum: 37007
	Urgent Pointer: 0
[INFO][handleTCPPacket()] The socket 4 is in state FINWAIT_2.
[INFO][handleTCPPacket()]TCB:
	SND.UNA: 1804289387
	SND.NXT: 1804289388
	SND.WND: 65528
	RCV.NXT: 1804289385
	RCV.WND: 524280
[INFO][handleTCPPacket()] The segment could not be received. Socket 4 send <SEQ=SND.NXT(1804289388)><ACK=RCV.NXT(1804289385)><CTL=ACK>
[INFO][handleTCPPacket()]
[INFO][TCPPacket::printTCPPacket()]
Pesudo Head: 
	Source Address: 10.100.1.1
	Destination Address: 10.100.1.2
	PTCL: 0x6
	TCP Length: 20
TCP Head: 
	Source Port: 1025
	Destination Port: 10000
	Sequence Number: 1804289385
	Acknowledgment Number: 1804289388
	URG: 0
	ACK: 1
	PSH: 0
	RST: 0
	SYN: 0
	FIN: 0
	Window: 65528
	Checksum: 37262
	Urgent Pointer: 0
[INFO][handleTCPPacket()] The socket 4 is in state FINWAIT_2.
[INFO][handleTCPPacket()]TCB:
	SND.UNA: 1804289387
	SND.NXT: 1804289388
	SND.WND: 65528
	RCV.NXT: 1804289385
	RCV.WND: 524280
[INFO][TCB::ackRetransQueue()] Socket 4; ACK 1804289388.
[INFO][close()] Socket 4 resend FIN/ACK: <SEG=SND.NXT(1804289388)><ACK=RCV.NXT(1804289385)><CTL=FIN,ACK>.
[INFO][handleTCPPacket()]
[INFO][TCPPacket::printTCPPacket()]
Pesudo Head: 
	Source Address: 10.100.1.1
	Destination Address: 10.100.1.2
	PTCL: 0x6
	TCP Length: 20
TCP Head: 
	Source Port: 1025
	Destination Port: 10000
	Sequence Number: 1804289384
	Acknowledgment Number: 1804289388
	URG: 0
	ACK: 1
	PSH: 0
	RST: 0
	SYN: 0
	FIN: 1
	Window: 65528
	Checksum: 37007
	Urgent Pointer: 0
[INFO][handleTCPPacket()] The socket 4 is in state FINWAIT_2.
[INFO][handleTCPPacket()]TCB:
	SND.UNA: 1804289387
	SND.NXT: 1804289388
	SND.WND: 65528
	RCV.NXT: 1804289385
	RCV.WND: 524280
[INFO][handleTCPPacket()] The segment could not be received. Socket 4 send <SEQ=SND.NXT(1804289388)><ACK=RCV.NXT(1804289385)><CTL=ACK>
[INFO][handleTCPPacket()]
[INFO][TCPPacket::printTCPPacket()]
Pesudo Head: 
	Source Address: 10.100.1.1
	Destination Address: 10.100.1.2
	PTCL: 0x6
	TCP Length: 20
TCP Head: 
	Source Port: 1025
	Destination Port: 10000
	Sequence Number: 1804289385
	Acknowledgment Number: 1804289388
	URG: 0
	ACK: 1
	PSH: 0
	RST: 0
	SYN: 0
	FIN: 0
	Window: 65528
	Checksum: 37262
	Urgent Pointer: 0
[INFO][handleTCPPacket()] The socket 4 is in state FINWAIT_2.
[INFO][handleTCPPacket()]TCB:
	SND.UNA: 1804289387
	SND.NXT: 1804289388
	SND.WND: 65528
	RCV.NXT: 1804289385
	RCV.WND: 524280
[INFO][TCB::ackRetransQueue()] Socket 4; ACK 1804289388.
[INFO][close()] Socket 4 resend FIN/ACK: <SEG=SND.NXT(1804289388)><ACK=RCV.NXT(1804289385)><CTL=FIN,ACK>.
[INFO][handleTCPPacket()]
[INFO][TCPPacket::printTCPPacket()]
Pesudo Head: 
	Source Address: 10.100.1.1
	Destination Address: 10.100.1.2
	PTCL: 0x6
	TCP Length: 20
TCP Head: 
	Source Port: 1025
	Destination Port: 10000
	Sequence Number: 1804289385
	Acknowledgment Number: 0
	URG: 0
	ACK: 0
	PSH: 0
	RST: 1
	SYN: 0
	FIN: 0
	Window: 65528
	Checksum: 20102
	Urgent Pointer: 0
[INFO][handleTCPPacket()] The socket 4 is in state FINWAIT_2.
[INFO][handleTCPPacket()]TCB:
	SND.UNA: 1804289387
	SND.NXT: 1804289388
	SND.WND: 65528
	RCV.NXT: 1804289385
	RCV.WND: 524280
[ERROR][handleTCPPacket()] The packet set RST, Connection refused. Delete the TCB.
[INFO][TCB::clearRetainsQueue()]
[INFO][TCB::clearReadBuffer()]
[INFO][TCB::change_state] State of socket change from FINWAIT_2 to CLOSED.
[INFO][close()] Socket 4 close successfully.
[INFO][close()]:
[INFO][TCB::change_state] State of socket change from LISTEN to CLOSED.
[INFO][TCB::change_state] State of socket change from CLOSED to CLOSED.
[INFO][close()] Socket 3 close successfully.
